<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hooridor.Gui.GameModeMenu</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#withGameModeMenu"><span class="hs-identifier hs-var">withGameModeMenu</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span class="hs-special">,</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier hs-var">EasyAi</span></a><span class="hs-special">,</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier hs-var">HardAi</span></a><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Graphics.Gloss</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Graphics.Gloss.Interface.Pure.Game</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Hooridor.Gui.Types.html"><span class="hs-identifier">Hooridor.Gui.Types</span></a><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">-- |Game mode menu state.</span><span>
</span><a name="line-13"></a><span class="hs-keyword">data</span><span> </span><a name="GMMenu"><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier">GMMenu</span></a></a><span> </span><a name="local-6989586621679062792"><a href="#local-6989586621679062792"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GMMenu"><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier">GMMenu</span></a></a><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- |Options which can be selected in this menu.</span><span>
</span><a name="line-16"></a><span class="hs-keyword">data</span><span> </span><a name="GMMenuResult"><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier">GMMenuResult</span></a></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LocalGame"><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier">LocalGame</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^No AI players, no networking, 2 to 4 players</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EasyAi"><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier">EasyAi</span></a></a><span> </span><span class="hs-comment">-- ^Easy AI player</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HardAi"><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier">HardAi</span></a></a><span> </span><span class="hs-comment">-- ^Hard AI player</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- |Menu option after the given option.</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- If there are no more options, returns the same option:</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- &gt;&gt;&gt; next Network = Network</span><span>
</span><a name="line-26"></a><span class="hs-identifier">next</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span>
</span><a name="line-27"></a><a name="next"><a href="Hooridor.Gui.GameModeMenu.html#next"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><a name="local-6989586621679062798"><a href="#local-6989586621679062798"><span class="hs-identifier">pc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062798"><span class="hs-identifier hs-var">pc</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062798"><span class="hs-identifier hs-var">pc</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier hs-var">EasyAi</span></a><span>
</span><a name="line-30"></a><span class="hs-identifier">next</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier hs-var">EasyAi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier hs-var">HardAi</span></a><span>
</span><a name="line-31"></a><span class="hs-identifier">next</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier hs-var">HardAi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier hs-var">HardAi</span></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- |Menu option before the given option.</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- If there are no options before this, returns the same option:</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- &gt;&gt;&gt; prev NoAi = NoAi</span><span>
</span><a name="line-37"></a><span class="hs-identifier">prev</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span>
</span><a name="line-38"></a><a name="prev"><a href="Hooridor.Gui.GameModeMenu.html#prev"><span class="hs-identifier">prev</span></a></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><a name="local-6989586621679062799"><a href="#local-6989586621679062799"><span class="hs-identifier">pc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062799"><span class="hs-identifier hs-var">pc</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062799"><span class="hs-identifier hs-var">pc</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-41"></a><span class="hs-identifier">prev</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier hs-var">EasyAi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><span class="hs-number">4</span><span>
</span><a name="line-42"></a><span class="hs-identifier">prev</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#HardAi"><span class="hs-identifier hs-var">HardAi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#EasyAi"><span class="hs-identifier hs-var">EasyAi</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- |Pattern for pressing key Up.</span><span>
</span><a name="line-45"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PressUp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Event</span><span>
</span><a name="line-46"></a><span class="hs-keyword">pattern</span><span> </span><a name="PressUp"><a href="Hooridor.Gui.GameModeMenu.html#PressUp"><span class="hs-identifier">PressUp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">EventKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecialKey</span><span> </span><span class="hs-identifier hs-var">KeyUp</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Down</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- |Pattern for pressing key Down.</span><span>
</span><a name="line-49"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PressDown</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Event</span><span>
</span><a name="line-50"></a><span class="hs-keyword">pattern</span><span> </span><a name="PressDown"><a href="Hooridor.Gui.GameModeMenu.html#PressDown"><span class="hs-identifier">PressDown</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">EventKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecialKey</span><span> </span><span class="hs-identifier hs-var">KeyDown</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Down</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- |Pattern for pressing key Enter.</span><span>
</span><a name="line-53"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PressEnter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Event</span><span>
</span><a name="line-54"></a><span class="hs-keyword">pattern</span><span> </span><a name="PressEnter"><a href="Hooridor.Gui.GameModeMenu.html#PressEnter"><span class="hs-identifier">PressEnter</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">EventKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecialKey</span><span> </span><span class="hs-identifier hs-var">KeyEnter</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Down</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- |Pattern for pressing key R.</span><span>
</span><a name="line-57"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PressR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Event</span><span>
</span><a name="line-58"></a><span class="hs-keyword">pattern</span><span> </span><a name="PressR"><a href="Hooridor.Gui.GameModeMenu.html#PressR"><span class="hs-identifier">PressR</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">EventKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Char</span><span> </span><span class="hs-char">'r'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Down</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- |Initial menu state.</span><span>
</span><a name="line-61"></a><span class="hs-identifier">initial</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-type">GMMenu</span></a><span> </span><a href="#local-6989586621679062797"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-62"></a><a name="initial"><a href="Hooridor.Gui.GameModeMenu.html#initial"><span class="hs-identifier">initial</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#LocalGame"><span class="hs-identifier hs-var">LocalGame</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- |Draw menu if there is no game, or draw game.</span><span>
</span><a name="line-65"></a><span class="hs-identifier">render</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hooridor.Gui.Types.html#Renderer"><span class="hs-identifier hs-type">Renderer</span></a><span> </span><a href="#local-6989586621679062796"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.Types.html#Renderer"><span class="hs-identifier hs-type">Renderer</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-type">GMMenu</span></a><span> </span><a href="#local-6989586621679062796"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><a name="render"><a href="Hooridor.Gui.GameModeMenu.html#render"><span class="hs-identifier">render</span></a></a><span> </span><a name="local-6989586621679063713"><a href="#local-6989586621679063713"><span class="hs-identifier">aRenderer</span></a></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063714"><a href="#local-6989586621679063714"><span class="hs-identifier">aState</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063713"><span class="hs-identifier hs-var">aRenderer</span></a><span> </span><a href="#local-6989586621679063714"><span class="hs-identifier hs-var">aState</span></a><span>
</span><a name="line-67"></a><span class="hs-identifier">render</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063715"><a href="#local-6989586621679063715"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">scale</span><span> </span><span class="hs-number">0.25</span><span> </span><span class="hs-number">0.25</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">250</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063715"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- |Handle menu events if there is no game, or pass event to game.</span><span>
</span><a name="line-71"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062795"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.Types.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><a href="#local-6989586621679062795"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.Types.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-type">GMMenu</span></a><span> </span><a href="#local-6989586621679062795"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><a name="handle"><a href="Hooridor.Gui.GameModeMenu.html#handle"><span class="hs-identifier">handle</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#PressR"><span class="hs-identifier hs-var">PressR</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#initial"><span class="hs-identifier hs-var">initial</span></a><span>
</span><a name="line-73"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#PressUp"><span class="hs-identifier hs-var">PressUp</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063763"><a href="#local-6989586621679063763"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#next"><span class="hs-identifier hs-var">next</span></a><span> </span><a href="#local-6989586621679063763"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-74"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#PressDown"><span class="hs-identifier hs-var">PressDown</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063764"><a href="#local-6989586621679063764"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#prev"><span class="hs-identifier hs-var">prev</span></a><span> </span><a href="#local-6989586621679063764"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-75"></a><span class="hs-identifier">handle</span><span> </span><a name="local-6989586621679063765"><a href="#local-6989586621679063765"><span class="hs-identifier">makeInitial</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#PressEnter"><span class="hs-identifier hs-var">PressEnter</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063766"><a href="#local-6989586621679063766"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a href="#local-6989586621679063766"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679063765"><span class="hs-identifier hs-var">makeInitial</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063766"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063767"><a href="#local-6989586621679063767"><span class="hs-identifier">state</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063767"><span class="hs-identifier hs-var">state</span></a><span>
</span><a name="line-78"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063768"><a href="#local-6989586621679063768"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679063769"><a href="#local-6989586621679063769"><span class="hs-identifier">event</span></a></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063770"><a href="#local-6989586621679063770"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063771"><a href="#local-6989586621679063771"><span class="hs-identifier">aState</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a href="#local-6989586621679063770"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679063768"><span class="hs-identifier hs-var">handler</span></a><span> </span><a href="#local-6989586621679063769"><span class="hs-identifier hs-var">event</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063771"><span class="hs-identifier hs-var">aState</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- |Handle per-time updates for menu (no updates) if there is no game,</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- or pass time update to game.</span><span>
</span><a name="line-83"></a><span class="hs-identifier">update</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hooridor.Gui.Types.html#Updater"><span class="hs-identifier hs-type">Updater</span></a><span> </span><a href="#local-6989586621679062794"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.Types.html#Updater"><span class="hs-identifier hs-type">Updater</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-type">GMMenu</span></a><span> </span><a href="#local-6989586621679062794"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><a name="update"><a href="Hooridor.Gui.GameModeMenu.html#update"><span class="hs-identifier">update</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063772"><a href="#local-6989586621679063772"><span class="hs-identifier">state</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063772"><span class="hs-identifier hs-var">state</span></a><span>
</span><a name="line-85"></a><span class="hs-identifier">update</span><span> </span><a name="local-6989586621679063773"><a href="#local-6989586621679063773"><span class="hs-identifier">updater</span></a></a><span> </span><a name="local-6989586621679063774"><a href="#local-6989586621679063774"><span class="hs-identifier">dt</span></a></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a name="local-6989586621679063775"><a href="#local-6989586621679063775"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063776"><a href="#local-6989586621679063776"><span class="hs-identifier">aState</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-var">GMMenu</span></a><span> </span><a href="#local-6989586621679063775"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679063773"><span class="hs-identifier hs-var">updater</span></a><span> </span><a href="#local-6989586621679063774"><span class="hs-identifier hs-var">dt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063776"><span class="hs-identifier hs-var">aState</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- |Add AI selection menu to a game.</span><span>
</span><a name="line-89"></a><span class="hs-identifier">withGameModeMenu</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenuResult"><span class="hs-identifier hs-type">GMMenuResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^Make initial game state with this AI level</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hooridor.Gui.Types.html#PlayType"><span class="hs-identifier hs-type">PlayType</span></a><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#GMMenu"><span class="hs-identifier hs-type">GMMenu</span></a><span> </span><a href="#local-6989586621679062793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^'play' function</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Display</span><span> </span><span class="hs-comment">-- ^Display to draw on</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color</span><span> </span><span class="hs-comment">-- ^Background color</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^FPS count</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.Types.html#Renderer"><span class="hs-identifier hs-type">Renderer</span></a><span> </span><a href="#local-6989586621679062793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^Rendering function for the game</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.Types.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><a href="#local-6989586621679062793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^Event handling function for the game</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.Types.html#Updater"><span class="hs-identifier hs-type">Updater</span></a><span> </span><a href="#local-6989586621679062793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^Per-time updating function for the game</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><a name="withGameModeMenu"><a href="Hooridor.Gui.GameModeMenu.html#withGameModeMenu"><span class="hs-identifier">withGameModeMenu</span></a></a><span>
</span><a name="line-100"></a><span>  </span><a name="local-6989586621679063777"><a href="#local-6989586621679063777"><span class="hs-identifier">makeInitial</span></a></a><span> </span><a name="local-6989586621679063778"><a href="#local-6989586621679063778"><span class="hs-identifier">play'</span></a></a><span> </span><a name="local-6989586621679063779"><a href="#local-6989586621679063779"><span class="hs-identifier">window'</span></a></a><span> </span><a name="local-6989586621679063780"><a href="#local-6989586621679063780"><span class="hs-identifier">background'</span></a></a><span> </span><a name="local-6989586621679063781"><a href="#local-6989586621679063781"><span class="hs-identifier">fps'</span></a></a><span> </span><a name="local-6989586621679063782"><a href="#local-6989586621679063782"><span class="hs-identifier">renderer</span></a></a><span> </span><a name="local-6989586621679063783"><a href="#local-6989586621679063783"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679063784"><a href="#local-6989586621679063784"><span class="hs-identifier">updater</span></a></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063778"><span class="hs-identifier hs-var">play'</span></a><span> </span><a href="#local-6989586621679063779"><span class="hs-identifier hs-var">window'</span></a><span> </span><a href="#local-6989586621679063780"><span class="hs-identifier hs-var">background'</span></a><span> </span><a href="#local-6989586621679063781"><span class="hs-identifier hs-var">fps'</span></a><span> </span><a href="Hooridor.Gui.GameModeMenu.html#initial"><span class="hs-identifier hs-var">initial</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#render"><span class="hs-identifier hs-var">render</span></a><span> </span><a href="#local-6989586621679063782"><span class="hs-identifier hs-var">renderer</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#handle"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679063777"><span class="hs-identifier hs-var">makeInitial</span></a><span> </span><a href="#local-6989586621679063783"><span class="hs-identifier hs-var">handler</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Hooridor.Gui.GameModeMenu.html#update"><span class="hs-identifier hs-var">update</span></a><span> </span><a href="#local-6989586621679063784"><span class="hs-identifier hs-var">updater</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a></pre></body></html>